```{r}

library(tidyverse)
library(dplyr)
library(readr)
library(ggplot2)
library(plotly)
library(GGally)


Beer = read.csv("/Unit 8/Beers.csv")
Brewery = read.csv("/Unit 8/Breweries.csv")

Beers = left_join(Beer, Brewery, by = c("Brewery_id" = "Brew_ID"))
Beers = Beers %>% filter(!is.na(ABV) & !is.na(Style))

Beers2 = Beers %>% filter(!is.na(IBU))


####### Part 1 #######

State_Count <- as.data.frame(table(Brewery$State))

State_Count <- arrange(State_Count, desc(Freq))

TopTen = head(State_Count,10)
LastTen = tail(State_Count,10)

State_Count %>% ggplot(aes(x = reorder(Var1, -Freq), y = Freq)) + geom_bar(stat = "identity") + labs(title="Number of Breweries per State", x="State", y="No. of Breweries")

TopTen %>% ggplot(aes(x = reorder(Var1, -Freq), y = Freq)) + geom_bar(stat = "identity", fill="blue") + labs(title="States with Most Breweries", x="State", y="No. of Breweries") + geom_text(aes(label=Freq), position=position_dodge(width=0.9), vjust=-0.25)

LastTen %>% ggplot(aes(x = reorder(Var1, -Freq), y = Freq)) + geom_bar(stat = "identity", fill="red") + labs(title="States with Least Breweries", x="State", y="No. of Breweries") + geom_text(aes(label=Freq), position=position_dodge(width=0.9), vjust=-0.25)


####### Part 4 #######

State_ABV <- aggregate(x = Beers$ABV, by = list(Beers$State), FUN = median)
State_IBU <- aggregate(x = Beers2$IBU, by = list(Beers2$State), FUN = median)

State_ABV <- arrange(State_ABV, desc(x))
State_IBU <- arrange(State_IBU, desc(x))

TopABV = head(State_ABV,10)
LastABV = tail(State_ABV,10)

TopIBU = head(State_IBU,10)
LastIBU = tail(State_IBU,10)

TopABV %>% ggplot(aes(x = reorder(Group.1, -x), y = x)) + geom_bar(stat = "identity", fill="blue") + labs(title="States Highest Median ABV", x="State", y="Median ABV") + geom_text(aes(label=x), position=position_dodge(width=0.9), vjust=-0.25)

LastABV %>% ggplot(aes(x = reorder(Group.1, -x), y = x)) + geom_bar(stat = "identity", fill="red") + labs(title="States Lowest Median ABV", x="State", y="Median ABV") + geom_text(aes(label=x), position=position_dodge(width=0.9), vjust=-0.25)

TopIBU %>% ggplot(aes(x = reorder(Group.1, -x), y = x)) + geom_bar(stat = "identity", fill="blue") + labs(title="States Highest Median IBU", x="State", y="Median IBU") + geom_text(aes(label=x), position=position_dodge(width=0.9), vjust=-0.25)

LastIBU %>% ggplot(aes(x = reorder(Group.1, -x), y = x)) + geom_bar(stat = "identity", fill="red") + labs(title="States Lowest Median IBU", x="State", y="Median IBU") + geom_text(aes(label=x), position=position_dodge(width=0.9), vjust=-0.25)


####### Part 6 #######

Beers %>% ggplot(aes(x = ABV, fill = State)) + geom_histogram(color = 'black') + labs(title="Distribution of ABV", x="ABV", y="Number of Beers")
Beers %>% ggplot(aes(x = ABV)) + geom_histogram(color = 'blue') + labs(title="Distribution of ABV", x="ABV", y="Number of Beers")
Beers %>% ggplot(aes(x = ABV)) + geom_line(aes(fill=..count..),stat="bin") + labs(title="Distribution of ABV", x="ABV", y="Number of Beers")
Beers %>% ggplot(aes(x = ABV)) + geom_boxplot()

summary(Beers$ABV)

MinABV = which.min(Beers$ABV)
Beers[MinABV,]

MaxABV = which.max(Beers$ABV)
Beers[MaxABV,]

```









